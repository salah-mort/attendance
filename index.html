<!DOCTYPE html>
<html dir="rtl" lang="ar">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ุฃุฏุงุฉ ุชุณุฌูู ุงูุญุถูุฑ ูุงูุบูุงุจ</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    <link rel="stylesheet" href="styles.css">
</head>

<body>
    <div class="container">
        <div class="header">
            <h1>๐ฏ ุฃุฏุงุฉ ุชุณุฌูู ุงูุญุถูุฑ ูุงูุบูุงุจ</h1>
            <p>ูุธุงู ุณุฑูุน ูุณูู ูุชุณุฌูู ุญุถูุฑ ุงูุนูุงู</p>
        </div>

        <div class="content">
            <div class="upload-section">
                <h2 style="margin-bottom: 20px;">๐ ุชุญููู ุงููููุงุช</h2>

                <div class="file-input-wrapper">
                    <input type="file" id="excelFile" accept=".xlsx,.xls">
                    <label for="excelFile">๐ ุงุฎุชุฑ ููู ุงูุฅูุณู</label>
                </div>

                <div class="date-input">
                    <label style="display: block; margin-bottom: 10px; font-weight: bold;">๐ ุงูุชุงุฑูุฎ:</label>
                    <input type="date" id="attendanceDate">
                </div>

                <div style="margin: 20px 0;">
                    <label
                        style="display: flex; align-items: center; justify-content: center; gap: 10px; cursor: pointer;">
                        <input type="checkbox" id="startWithAbsent" checked
                            style="width: 20px; height: 20px; cursor: pointer;">
                        <span style="font-weight: bold; font-size: 1.1em;">ุงุจุฏุฃ ุจุฌุนู ุงูุฌููุน ุบุงุฆุจูู (ุงููุฑ ุนูู ุงูุงุณู ููุตุจุญ
                            ุญุงุถุฑ)</span>
                    </label>
                </div>

                <div id="fileInfo" style="margin-top: 15px;"></div>
            </div>

            <div id="statsSection" style="display: none;">
                <div class="stats">
                    <div class="stat-item">
                        <div class="stat-value" id="totalCount">0</div>
                        <div class="stat-label">ุฅุฌูุงูู ุงูุนูุงู</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-value" id="presentCount" style="color: #28a745;">0</div>
                        <div class="stat-label">ุญุงุถุฑ</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-value" id="absentCount" style="color: #dc3545;">0</div>
                        <div class="stat-label">ุบุงุฆุจ</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-value" id="unmarkedCount" style="color: #ffc107;">0</div>
                        <div class="stat-label">ุบูุฑ ูุญุฏุฏ</div>
                    </div>
                </div>
            </div>

            <div id="quickActionsSection" style="display: none;">
                <div class="quick-actions">
                    <button class="quick-btn all-absent-btn" onclick="markAllAbsent()">
                        โ ุงูุฌููุน ุบุงุฆุจ
                    </button>
                    <button class="quick-btn all-present-btn" onclick="markAllPresent()">
                        โ ุงูุฌููุน ุญุงุถุฑ
                    </button>
                    <button class="quick-btn clear-all-btn" onclick="clearAll()">
                        ๐ ูุณุญ ุงููู
                    </button>
                    <button class="quick-btn" style="background: #17a2b8; color: white;" onclick="toggleBulkMode()">
                        ๐ฆ ูุถุน ุงูุงุฎุชูุงุฑ ุงููุชุนุฏุฏ
                    </button>
                    <button class="quick-btn" id="continuousVoiceBtn"
                        style="background: #ff6b6b; color: white; display: none;" onclick="toggleContinuousVoice()">
                        ๐ค ุชุดุบูู ุงูุจุญุซ ุงููุณุชูุฑ
                    </button>
                    <button class="quick-btn" style="background: #6c757d; color: white;" onclick="printReport()">
                        ๐จ๏ธ ุทุจุงุนุฉ
                    </button>
                    <button class="quick-btn" style="background: #28a745; color: white;" onclick="exportToCSV()">
                        ๐ ุชุตุฏูุฑ CSV
                    </button>
                </div>

                <div class="filter-buttons">
                    <button class="filter-btn active" onclick="filterEmployees('all')">ุงููู</button>
                    <button class="filter-btn" onclick="filterEmployees('present')">ุงูุญุงุถุฑูู ููุท</button>
                    <button class="filter-btn" onclick="filterEmployees('absent')">ุงูุบุงุฆุจูู ููุท</button>
                    <button class="filter-btn" onclick="filterEmployees('unmarked')">ุบูุฑ ูุญุฏุฏ</button>
                </div>

                <div class="shortcuts-panel" id="shortcutsPanel" style="display: none;">
                    <h3 style="margin-bottom: 10px; color: #667eea;">โจ๏ธ ุงุฎุชุตุงุฑุงุช ููุญุฉ ุงูููุงุชูุญ</h3>
                    <div class="shortcuts-grid">
                        <div class="shortcut-item">
                            <span class="shortcut-key">Ctrl + S</span> ุญูุธ
                        </div>
                        <div class="shortcut-item">
                            <span class="shortcut-key">Ctrl + F</span> ุจุญุซ
                        </div>
                        <div class="shortcut-item">
                            <span class="shortcut-key">Ctrl + Z</span> ุชุฑุงุฌุน
                        </div>
                        <div class="shortcut-item">
                            <span class="shortcut-key">Ctrl + P</span> ุทุจุงุนุฉ
                        </div>
                        <div class="shortcut-item">
                            <span class="shortcut-key">Ctrl + A</span> ุงูุฌููุน ุญุงุถุฑ
                        </div>
                        <div class="shortcut-item">
                            <span class="shortcut-key">Ctrl + D</span> ุงูุฌููุน ุบุงุฆุจ
                        </div>
                        <div class="shortcut-item">
                            <span class="shortcut-key">?</span> ุฅุธูุงุฑ/ุฅุฎูุงุก ุงูุงุฎุชุตุงุฑุงุช
                        </div>
                    </div>
                </div>
            </div>

            <div id="searchSection" style="display: none;">
                <div
                    style="background: #d1ecf1; padding: 10px; border-radius: 8px; margin-bottom: 10px; font-size: 0.9em; color: #0c5460;">
                    ๐ก <strong>ูุตูุญุฉ:</strong> ุนูุฏ ุฃูู ุงุณุชุฎุฏุงู ูููููุฑููููุ ุงุถุบุท "ุงูุณูุงุญ" ููุนูู ุงูุจุญุซ ุงูุตูุชู ุจุฏูู ุทูุจ
                    ุงูุฅุฐู ูุฌุฏุฏุงู
                </div>
                <div class="search-box" style="margin: 0 auto;">
                    <input type="text" id="searchInput" placeholder="๐ ุงุจุญุซ ุนู ุงุณู ุงูุนุงูู...">
                    <button class="voice-btn" id="voiceBtn" onclick="startVoiceSearch()" title="ุงูุจุญุซ ุงูุตูุชู">
                        ๐ค
                    </button>
                </div>
                <div id="voiceStatus" style="text-align: center; margin-top: 10px; color: #666; font-weight: bold;">
                </div>
            </div>

            <div id="employeeSection" style="display: none;">
                <div class="employee-grid" id="employeeGrid"></div>

                <div class="action-buttons">
                    <button class="action-btn save-btn" onclick="saveAttendance()">๐พ ุญูุธ ุงูุชุนุฏููุงุช</button>
                    <button class="action-btn reset-btn" onclick="resetAll()">๐ ุฅุนุงุฏุฉ ุชุนููู</button>
                </div>
            </div>
        </div>
    </div>

    <button class="undo-btn no-print" id="undoBtn" onclick="undoLastAction()">
        โถ ุชุฑุงุฌุน
    </button>
    <footer id="site-footer">
        <div class="footer-content">
            <p>&copy; 2026 Salah Mortaja - ุฃุฏุงุฉ ุชุณุฌูู ุงูุญุถูุฑ ูุงูุบูุงุจ</p>
            <a href="https://linktr.ee/salah.mort" target="_blank" rel="noopener noreferrer">๐ ุชูุงุตู ูุนู</a>
        </div>
    </footer>
    <!-- Link the JavaScript file here -->
    <script src="scripts.js"></script>
</body>

</html>